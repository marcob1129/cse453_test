<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Offline Image Map</title>

    <link rel="stylesheet" href="/static/leaflet.css">
    <script src="/static/leaflet.js"></script>
    <script src="/static/socket.io.min.js"></script>

    <style>
        html, body { height: 100%; margin: 0; }
        #map { height: 100%; }
        
        .leaflet-div-icon {
            display: none !important;
        }
    </style>
</head>
<body>

<div id="map"></div>

<script>
    
    var map = L.map("map", {
        zoomControl: true,
        attributionControl: false
    });

    
    var imageBounds = [
        //southwest , northeast
        [43.00393007104246, -78.77869348098584],
        [42.99696023197851, -78.79764062766652]
    ];

    
    L.imageOverlay("/static/map.png", imageBounds).addTo(map);
    map.fitBounds(imageBounds);

 
    var marker = L.circleMarker([43.0018, -78.7895], {
        color: 'blue',
        fillColor: '#30f',
        fillOpacity: 0.8,
        radius: 10,
        weight: 2
    }).addTo(map);



    
    var path = L.polyline([], {
        color: "red",
        weight: 3
    }).addTo(map);

    
    var socket = io();

    socket.on("connect", function() {
        console.log("Connected to server");
    });

    socket.on("gps_update", function(data) {
        var latlng = [data.lat, data.lon];
        marker.setLatLng(latlng);
        path.addLatLng(latlng);
    });
</script>

</body>
</html>